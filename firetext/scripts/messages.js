function MessageProxy(){function f(a){if(a.source===e){if(!b[a.data.command])throw Error('No command registered: "'+a.data.command+'"');b[a.data.command].callback(a);b[a.data.command]&&b[a.data.command].useOnce&&g.unRegisterMessageHandler(a.data.command)}}var e,c,b={},g=this;this.registerMessageHandler=function(a,d,c){if("function"!==typeof a)throw new TypeError("callback must be a function");if(!d)for(d=0;b[d];)d++;b[d]={callback:a,useOnce:!!c};return d};this.unRegisterMessageHandler=function(a){b[a]=
void 0};this.postMessage=function(a){e.postMessage(a,"*")};this.setSend=function(a){e=a};this.setRecv=function(a){c&&c.removeEventListener("message",f,!1);(c=a)&&c.addEventListener("message",f,!1)}};
